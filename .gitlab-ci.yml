test:
  stage: test
  image: python:3.11
  script:
    - pip install tox coverage coverage-badge
    - tox
    - coverage run -m pytest
    - coverage-badge -o badge.svg
    - git config --global user.name "GitLab Runner"
    - git config --global user.email "gitlab-runner@example.com"
    - git add badge.svg
    - git commit -m "Mise Ã  jour du badge de couverture des tests"
    - git push origin main
  tags:
    - docker
